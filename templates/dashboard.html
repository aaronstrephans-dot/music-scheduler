<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard ‚Äî Music Scheduler</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#070a12;
  --bg2:#0c0f1a;
  --surface:rgba(255,255,255,0.035);
  --surface-solid:#111827;
  --border:rgba(255,255,255,0.07);
  --border-bright:rgba(255,255,255,0.14);
  --accent:#7c6cf0;
  --accent-dim:rgba(124,108,240,0.18);
  --accent-glow:rgba(124,108,240,0.35);
  --accent2:#f472b6;
  --text:#f1f5f9;
  --text2:#94a3b8;
  --text3:#475569;
  --success:#34d399;
  --danger:#f87171;
  --warn:#fbbf24;
  --info:#60a5fa;
  --sidebar-w:220px;
}
html,body{height:100%;background:var(--bg);color:var(--text);font-family:'Inter',system-ui,sans-serif;font-size:14px;-webkit-font-smoothing:antialiased}

/* ‚îÄ‚îÄ App shell ‚îÄ‚îÄ */
.app{display:flex;min-height:100vh}

/* ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ */
.sidebar{
  width:var(--sidebar-w);flex-shrink:0;
  background:var(--bg2);
  border-right:1px solid var(--border);
  display:flex;flex-direction:column;
  position:fixed;inset:0 auto 0 0;
  z-index:50;
}
.sidebar-logo{
  display:flex;align-items:center;gap:10px;
  padding:22px 20px 20px;
  border-bottom:1px solid var(--border);
}
.logo-icon{
  width:34px;height:34px;border-radius:10px;
  background:linear-gradient(135deg,#7c6cf0,#f472b6);
  display:flex;align-items:center;justify-content:center;
  font-size:17px;flex-shrink:0;
  box-shadow:0 4px 12px rgba(124,108,240,0.4);
}
.logo-text{font-weight:700;font-size:15px;letter-spacing:-.3px;color:var(--text)}
.logo-sub{font-size:10px;color:var(--text3);font-weight:500;letter-spacing:.5px;text-transform:uppercase}

.sidebar-section{padding:16px 12px 8px;font-size:10px;font-weight:600;letter-spacing:.8px;text-transform:uppercase;color:var(--text3)}

.nav-item{
  display:flex;align-items:center;gap:10px;
  padding:9px 12px;margin:2px 8px;
  border-radius:8px;text-decoration:none;
  color:var(--text2);font-weight:500;font-size:13.5px;
  transition:all .15s;cursor:pointer;position:relative;
}
.nav-item:hover{background:rgba(255,255,255,0.05);color:var(--text)}
.nav-item.active{background:var(--accent-dim);color:var(--accent)}
.nav-item.active::before{
  content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);
  width:3px;height:18px;background:var(--accent);border-radius:0 2px 2px 0;
}
.nav-icon{font-size:16px;width:20px;text-align:center;flex-shrink:0}

.sidebar-bottom{margin-top:auto;padding:16px;border-top:1px solid var(--border)}
.station-pill{
  display:flex;align-items:center;gap:10px;
  background:rgba(255,255,255,0.04);border:1px solid var(--border);
  border-radius:10px;padding:10px 12px;
}
.station-avatar{
  width:30px;height:30px;border-radius:8px;
  background:linear-gradient(135deg,#7c6cf0,#f472b6);
  display:flex;align-items:center;justify-content:center;
  font-size:12px;font-weight:700;color:#fff;flex-shrink:0;
}
.station-name{font-weight:600;font-size:12.5px;color:var(--text)}
.station-role{font-size:11px;color:var(--text3)}

/* ‚îÄ‚îÄ Main ‚îÄ‚îÄ */
.main{margin-left:var(--sidebar-w);flex:1;display:flex;flex-direction:column;min-height:100vh}

.topbar{
  padding:20px 32px;display:flex;align-items:center;justify-content:space-between;
  border-bottom:1px solid var(--border);
  background:rgba(7,10,18,0.7);
  backdrop-filter:blur(20px);
  position:sticky;top:0;z-index:40;
}
.topbar-title{font-size:20px;font-weight:700;letter-spacing:-.4px}
.topbar-sub{font-size:12px;color:var(--text2);margin-top:2px}
.topbar-right{display:flex;align-items:center;gap:10px}

.badge-live{
  display:flex;align-items:center;gap:6px;
  background:rgba(52,211,153,0.12);border:1px solid rgba(52,211,153,0.25);
  border-radius:20px;padding:5px 12px;
  font-size:12px;font-weight:600;color:var(--success);
}
.dot-live{width:6px;height:6px;border-radius:50%;background:var(--success);animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(.8)}}

.content{padding:28px 32px;flex:1}

/* ‚îÄ‚îÄ Stat cards ‚îÄ‚îÄ */
.stats-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-bottom:28px}
.stat-card{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:14px;padding:20px;
  position:relative;overflow:hidden;
  transition:border-color .2s,transform .2s;
  backdrop-filter:blur(12px);
}
.stat-card:hover{border-color:var(--border-bright);transform:translateY(-2px)}
.stat-card::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(255,255,255,0.03),transparent);
  pointer-events:none;
}
.stat-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:14px}
.stat-label{font-size:11.5px;font-weight:600;letter-spacing:.4px;text-transform:uppercase;color:var(--text3)}
.stat-icon{
  width:36px;height:36px;border-radius:10px;
  display:flex;align-items:center;justify-content:center;font-size:17px;
  background:rgba(255,255,255,0.06);
}
.stat-icon.purple{background:rgba(124,108,240,0.15);color:var(--accent)}
.stat-icon.green{background:rgba(52,211,153,0.12);color:var(--success)}
.stat-icon.blue{background:rgba(96,165,250,0.12);color:var(--info)}
.stat-icon.pink{background:rgba(244,114,182,0.12);color:var(--accent2)}
.stat-value{font-size:32px;font-weight:800;letter-spacing:-1px;line-height:1;margin-bottom:6px}
.stat-change{font-size:12px;color:var(--text2)}
.stat-change .up{color:var(--success)}
.stat-change .down{color:var(--danger)}

.stat-bar{height:3px;background:rgba(255,255,255,0.06);border-radius:3px;margin-top:14px}
.stat-bar-fill{height:100%;border-radius:3px;background:linear-gradient(90deg,var(--accent),var(--accent2));transition:width .6s ease}

/* ‚îÄ‚îÄ Section cards ‚îÄ‚îÄ */
.section-grid{display:grid;grid-template-columns:1fr 340px;gap:20px;margin-bottom:28px}
@media(max-width:1100px){.section-grid{grid-template-columns:1fr}}

.card{
  background:var(--surface);border:1px solid var(--border);
  border-radius:14px;overflow:hidden;
  backdrop-filter:blur(12px);
}
.card-header{
  padding:18px 20px;display:flex;align-items:center;justify-content:space-between;
  border-bottom:1px solid var(--border);
}
.card-title{font-weight:700;font-size:14px;color:var(--text)}
.card-subtitle{font-size:12px;color:var(--text3);margin-top:2px}
.card-body{padding:16px 20px}

/* Quick Actions */
.action-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.action-btn{
  display:flex;flex-direction:column;align-items:center;gap:8px;
  padding:16px 12px;border:1px solid var(--border);
  border-radius:12px;background:rgba(255,255,255,0.02);
  cursor:pointer;transition:all .2s;text-decoration:none;color:var(--text2);
  font-size:12px;font-weight:500;
}
.action-btn:hover{background:var(--accent-dim);border-color:rgba(124,108,240,0.3);color:var(--accent);transform:translateY(-2px)}
.action-btn-icon{font-size:24px}
.action-btn.primary{grid-column:1/-1;flex-direction:row;gap:12px;font-size:13.5px;font-weight:600;background:var(--accent-dim);border-color:rgba(124,108,240,0.3);color:var(--accent);padding:14px 18px}
.action-btn.primary:hover{background:rgba(124,108,240,0.25);box-shadow:0 0 20px var(--accent-glow)}

/* Timeline / Activity */
.timeline{list-style:none}
.timeline-item{
  display:flex;gap:12px;padding:12px 0;
  border-bottom:1px solid var(--border);
}
.timeline-item:last-child{border-bottom:none}
.timeline-dot{
  width:8px;height:8px;border-radius:50%;margin-top:5px;flex-shrink:0;
  box-shadow:0 0 6px currentColor;
}
.timeline-dot.green{color:var(--success);background:var(--success)}
.timeline-dot.blue{color:var(--info);background:var(--info)}
.timeline-dot.warn{color:var(--warn);background:var(--warn)}
.timeline-dot.muted{color:var(--text3);background:var(--text3)}
.timeline-content{flex:1;min-width:0}
.timeline-text{font-size:13px;color:var(--text2);line-height:1.4}
.timeline-text strong{color:var(--text);font-weight:600}
.timeline-time{font-size:11px;color:var(--text3);margin-top:3px}
.tl-badge{display:inline-block;padding:1px 7px;border-radius:20px;font-size:10px;font-weight:600;margin-left:6px;vertical-align:middle}
.tl-badge.ok{background:rgba(52,211,153,0.15);color:var(--success)}
.tl-badge.warn{background:rgba(251,191,36,0.15);color:var(--warn)}

/* Fill ring */
.fill-ring-wrap{display:flex;align-items:center;gap:20px;padding:4px 0 12px}
.fill-ring{position:relative;flex-shrink:0}
.fill-ring svg{transform:rotate(-90deg)}
.fill-ring-label{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.fill-ring-pct{font-size:20px;font-weight:800;color:var(--text)}
.fill-ring-sub{font-size:10px;color:var(--text3);font-weight:500}
.fill-stats{flex:1}
.fill-stat-row{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px solid var(--border)}
.fill-stat-row:last-child{border-bottom:none}
.fill-stat-name{font-size:12px;color:var(--text2)}
.fill-stat-val{font-size:12px;font-weight:600;color:var(--text)}

/* Status indicators */
.status-row{display:flex;align-items:center;gap:8px;padding:10px 12px;background:rgba(52,211,153,0.05);border:1px solid rgba(52,211,153,0.12);border-radius:10px;margin-top:14px}
.status-dot{width:7px;height:7px;border-radius:50%;background:var(--success);animation:pulse 2s infinite;flex-shrink:0}
.status-text{font-size:12px;color:var(--success);font-weight:500}

/* Buttons */
.btn{display:inline-flex;align-items:center;gap:7px;padding:8px 16px;border:none;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;transition:all .15s;text-decoration:none;font-family:inherit}
.btn-accent{background:var(--accent);color:#fff;box-shadow:0 0 0 0 var(--accent-glow)}
.btn-accent:hover{box-shadow:0 0 18px var(--accent-glow);transform:translateY(-1px)}
.btn-ghost{background:rgba(255,255,255,0.04);color:var(--text2);border:1px solid var(--border)}
.btn-ghost:hover{background:rgba(255,255,255,0.08);color:var(--text)}
.btn-sm{padding:5px 11px;font-size:12px}
</style>
</head>
<body>
<div class="app">

<!-- ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ -->
<aside class="sidebar">
  <div class="sidebar-logo">
    <div class="logo-icon">üéµ</div>
    <div>
      <div class="logo-text">MusicSched</div>
      <div class="logo-sub">Pro</div>
    </div>
  </div>

  <div class="sidebar-section">Main</div>
  <a href="/" class="nav-item active">
    <span class="nav-icon">‚äû</span>Dashboard
  </a>
  <a href="/generate" class="nav-item">
    <span class="nav-icon">‚ú¶</span>Generate Schedule
  </a>
  <a href="/view" class="nav-item">
    <span class="nav-icon">‚ó´</span>View Schedule
  </a>
  <a href="/export" class="nav-item">
    <span class="nav-icon">‚Üë</span>Export Logs
  </a>

  <div class="sidebar-section">Library</div>
  <a href="#" class="nav-item">
    <span class="nav-icon">‚ô™</span>Song Library
  </a>
  <a href="#" class="nav-item">
    <span class="nav-icon">‚è±</span>Clock Templates
  </a>
  <a href="#" class="nav-item">
    <span class="nav-icon">‚óà</span>Rules Engine
  </a>

  <div class="sidebar-bottom">
    <div class="station-pill">
      <div class="station-avatar">P</div>
      <div>
        <div class="station-name">Praise FM</div>
        <div class="station-role">Administrator</div>
      </div>
    </div>
  </div>
</aside>

<!-- ‚îÄ‚îÄ Main ‚îÄ‚îÄ -->
<div class="main">
  <header class="topbar">
    <div>
      <div class="topbar-title">Dashboard</div>
      <div class="topbar-sub">Welcome back ‚Äî here's your weekly overview</div>
    </div>
    <div class="topbar-right">
      <div class="badge-live"><span class="dot-live"></span>System Online</div>
      <button class="btn btn-accent" onclick="window.location.href='/generate'">‚ú¶ Generate Week</button>
    </div>
  </header>

  <div class="content">

    <!-- Stats row -->
    <div class="stats-row">
      <div class="stat-card">
        <div class="stat-header">
          <span class="stat-label">Song Library</span>
          <div class="stat-icon purple">‚ô™</div>
        </div>
        <div class="stat-value" id="stat-songs">‚Äî</div>
        <div class="stat-change"><span class="up" id="stat-active">‚Äî</span> active tracks</div>
        <div class="stat-bar"><div class="stat-bar-fill" id="bar-songs" style="width:0%"></div></div>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <span class="stat-label">Current Week</span>
          <div class="stat-icon blue">üìÖ</div>
        </div>
        <div class="stat-value" id="stat-week" style="font-size:20px;letter-spacing:-.5px;padding-top:6px">‚Äî</div>
        <div class="stat-change" id="stat-slots">‚Äî slots scheduled</div>
        <div class="stat-bar"><div class="stat-bar-fill" style="width:100%;background:linear-gradient(90deg,var(--info),var(--accent))"></div></div>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <span class="stat-label">Fill Rate</span>
          <div class="stat-icon green">‚óâ</div>
        </div>
        <div class="stat-value" id="stat-fill">‚Äî%</div>
        <div class="stat-change" id="stat-fill-detail">Loading...</div>
        <div class="stat-bar"><div class="stat-bar-fill" id="bar-fill" style="width:0%;background:linear-gradient(90deg,var(--success),#34d399)"></div></div>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <span class="stat-label">Export Status</span>
          <div class="stat-icon pink">‚Üë</div>
        </div>
        <div class="stat-value" style="font-size:20px;padding-top:6px;color:var(--success)">Ready</div>
        <div class="stat-change">Zetta ¬∑ WideOrbit ¬∑ ENCO ¬∑ CSV</div>
        <div class="stat-bar"><div class="stat-bar-fill" style="width:100%;background:linear-gradient(90deg,var(--accent2),#fb7185)"></div></div>
      </div>
    </div>

    <!-- Main grid -->
    <div class="section-grid">

      <!-- Activity feed -->
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Recent Activity</div>
            <div class="card-subtitle">Latest scheduling events</div>
          </div>
          <button class="btn btn-ghost btn-sm">View all</button>
        </div>
        <div class="card-body">
          <ul class="timeline">
            <li class="timeline-item">
              <div class="timeline-dot green"></div>
              <div class="timeline-content">
                <div class="timeline-text">
                  <strong>Week schedule generated</strong> for Feb 16‚Äì22
                  <span class="tl-badge ok">Completed</span>
                </div>
                <div class="timeline-time">2 hours ago</div>
              </div>
            </li>
            <li class="timeline-item">
              <div class="timeline-dot blue"></div>
              <div class="timeline-content">
                <div class="timeline-text"><strong>Zetta LOG export</strong> completed ‚Äî 7 files</div>
                <div class="timeline-time">5 hours ago</div>
              </div>
            </li>
            <li class="timeline-item">
              <div class="timeline-dot green"></div>
              <div class="timeline-content">
                <div class="timeline-text"><strong>Music1 import</strong> ‚Äî 3,689 songs, 906 artists</div>
                <div class="timeline-time">Yesterday</div>
              </div>
            </li>
            <li class="timeline-item">
              <div class="timeline-dot warn"></div>
              <div class="timeline-content">
                <div class="timeline-text">
                  Artist separation warning detected
                  <span class="tl-badge warn">Warning</span>
                </div>
                <div class="timeline-time">2 days ago</div>
              </div>
            </li>
            <li class="timeline-item">
              <div class="timeline-dot muted"></div>
              <div class="timeline-content">
                <div class="timeline-text"><strong>Category rules</strong> updated ‚Äî 32 categories</div>
                <div class="timeline-time">3 days ago</div>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <!-- Right column -->
      <div style="display:flex;flex-direction:column;gap:16px">

        <!-- Quick actions -->
        <div class="card">
          <div class="card-header">
            <div class="card-title">Quick Actions</div>
          </div>
          <div class="card-body">
            <div class="action-grid">
              <a href="/generate" class="action-btn primary">
                <span class="action-btn-icon">‚ú¶</span>
                Generate New Week
              </a>
              <a href="/view" class="action-btn">
                <span class="action-btn-icon">‚ó´</span>View Schedule
              </a>
              <a href="/export" class="action-btn">
                <span class="action-btn-icon">‚Üë</span>Export Logs
              </a>
              <a href="#" class="action-btn">
                <span class="action-btn-icon">‚ô™</span>Song Library
              </a>
              <a href="#" class="action-btn">
                <span class="action-btn-icon">‚è±</span>Clock Editor
              </a>
            </div>
          </div>
        </div>

        <!-- System status -->
        <div class="card">
          <div class="card-header">
            <div class="card-title">System Status</div>
          </div>
          <div class="card-body">
            <div class="fill-stat-row">
              <span class="fill-stat-name">Rotation Engine</span>
              <span class="fill-stat-val" style="color:var(--success)">‚óè Online</span>
            </div>
            <div class="fill-stat-row">
              <span class="fill-stat-name">Song Library</span>
              <span class="fill-stat-val" id="sys-songs">Loading...</span>
            </div>
            <div class="fill-stat-row">
              <span class="fill-stat-name">Clock Templates</span>
              <span class="fill-stat-val" style="color:var(--success)">‚óè Ready</span>
            </div>
            <div class="fill-stat-row">
              <span class="fill-stat-name">AI Assistant</span>
              <span class="fill-stat-val" id="sys-ai">Checking...</span>
            </div>
            <div class="status-row" style="margin-top:12px">
              <div class="status-dot"></div>
              <div class="status-text">All systems operational</div>
            </div>
          </div>
        </div>

      </div>
    </div>

  </div>
</div>
</div>

<script>
async function loadStats() {
  try {
    const [statsRes, statusRes] = await Promise.all([
      fetch('/api/stats'),
      fetch('/api/status'),
    ]);
    const stats  = await statsRes.json();
    const status = await statusRes.json();

    if (!stats.error) {
      document.getElementById('stat-songs').textContent  = (stats.total_songs || 0).toLocaleString();
      document.getElementById('stat-active').textContent = (stats.active_songs || 0).toLocaleString();
      document.getElementById('stat-week').textContent   = stats.current_week || '‚Äî';
      document.getElementById('stat-fill').textContent   = (stats.fill_rate || 0).toFixed(1) + '%';
      document.getElementById('stat-fill-detail').textContent = `${(stats.slots_filled||0).toLocaleString()} of ${(stats.total_slots||0).toLocaleString()} slots`;
      document.getElementById('stat-slots').textContent  = `${(stats.slots_filled||0).toLocaleString()} slots scheduled`;
      document.getElementById('bar-songs').style.width   = Math.min((stats.active_songs / Math.max(stats.total_songs, 1)) * 100, 100) + '%';
      document.getElementById('bar-fill').style.width    = Math.min(stats.fill_rate || 0, 100) + '%';
      document.getElementById('sys-songs').textContent   = `${(stats.total_songs||0).toLocaleString()} tracks`;
      document.getElementById('sys-songs').style.color   = 'var(--success)';
    }
    if (status) {
      document.getElementById('sys-ai').textContent  = status.ai_available ? '‚óè Online' : '‚óã Not configured';
      document.getElementById('sys-ai').style.color  = status.ai_available ? 'var(--success)' : 'var(--text3)';
    }
  } catch(e) { console.error(e); }
}
window.addEventListener('DOMContentLoaded', loadStats);
</script>
</body>
</html>
