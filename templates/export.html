<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Export Logs ‚Äî Music Scheduler</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#070a12;--bg2:#0c0f1a;
  --surface:rgba(255,255,255,0.035);--border:rgba(255,255,255,0.07);--border-bright:rgba(255,255,255,0.14);
  --accent:#7c6cf0;--accent-dim:rgba(124,108,240,0.18);--accent-glow:rgba(124,108,240,0.35);--accent2:#f472b6;
  --text:#f1f5f9;--text2:#94a3b8;--text3:#475569;
  --success:#34d399;--danger:#f87171;--warn:#fbbf24;--info:#60a5fa;--sidebar-w:220px;
}
html,body{height:100%;background:var(--bg);color:var(--text);font-family:'Inter',system-ui,sans-serif;font-size:14px;-webkit-font-smoothing:antialiased}
.app{display:flex;min-height:100vh}

/* Sidebar (same pattern) */
.sidebar{width:var(--sidebar-w);flex-shrink:0;background:var(--bg2);border-right:1px solid var(--border);display:flex;flex-direction:column;position:fixed;inset:0 auto 0 0;z-index:50}
.sidebar-logo{display:flex;align-items:center;gap:10px;padding:22px 20px 20px;border-bottom:1px solid var(--border)}
.logo-icon{width:34px;height:34px;border-radius:10px;background:linear-gradient(135deg,#7c6cf0,#f472b6);display:flex;align-items:center;justify-content:center;font-size:17px;flex-shrink:0;box-shadow:0 4px 12px rgba(124,108,240,0.4)}
.logo-text{font-weight:700;font-size:15px;letter-spacing:-.3px}
.logo-sub{font-size:10px;color:var(--text3);font-weight:500;letter-spacing:.5px;text-transform:uppercase}
.sidebar-section{padding:16px 12px 8px;font-size:10px;font-weight:600;letter-spacing:.8px;text-transform:uppercase;color:var(--text3)}
.nav-item{display:flex;align-items:center;gap:10px;padding:9px 12px;margin:2px 8px;border-radius:8px;text-decoration:none;color:var(--text2);font-weight:500;font-size:13.5px;transition:all .15s;position:relative}
.nav-item:hover{background:rgba(255,255,255,0.05);color:var(--text)}
.nav-item.active{background:var(--accent-dim);color:var(--accent)}
.nav-item.active::before{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:3px;height:18px;background:var(--accent);border-radius:0 2px 2px 0}
.nav-icon{font-size:16px;width:20px;text-align:center;flex-shrink:0}
.sidebar-bottom{margin-top:auto;padding:16px;border-top:1px solid var(--border)}
.station-pill{display:flex;align-items:center;gap:10px;background:rgba(255,255,255,0.04);border:1px solid var(--border);border-radius:10px;padding:10px 12px}
.station-avatar{width:30px;height:30px;border-radius:8px;background:linear-gradient(135deg,#7c6cf0,#f472b6);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:#fff;flex-shrink:0}
.station-name{font-weight:600;font-size:12.5px}
.station-role{font-size:11px;color:var(--text3)}

/* Main */
.main{margin-left:var(--sidebar-w);flex:1;display:flex;flex-direction:column;min-height:100vh}
.topbar{padding:20px 32px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);background:rgba(7,10,18,0.7);backdrop-filter:blur(20px);position:sticky;top:0;z-index:40}
.topbar-title{font-size:20px;font-weight:700;letter-spacing:-.4px}
.topbar-sub{font-size:12px;color:var(--text2);margin-top:2px}
.topbar-right{display:flex;gap:10px}
.content{padding:28px 32px;flex:1}

.btn{display:inline-flex;align-items:center;gap:7px;padding:8px 16px;border:none;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;transition:all .15s;font-family:inherit;text-decoration:none}
.btn-accent{background:var(--accent);color:#fff}
.btn-accent:hover{box-shadow:0 0 18px var(--accent-glow);transform:translateY(-1px)}
.btn-ghost{background:rgba(255,255,255,0.04);color:var(--text2);border:1px solid var(--border)}
.btn-ghost:hover{background:rgba(255,255,255,0.08);color:var(--text)}
.btn-success{background:rgba(52,211,153,0.15);color:var(--success);border:1px solid rgba(52,211,153,0.2)}
.btn-success:hover{background:rgba(52,211,153,0.25)}

/* Alert */
.alert{padding:12px 16px;border-radius:10px;margin-bottom:20px;font-size:13px;font-weight:500;display:none}
.alert.show{display:flex;align-items:center;gap:10px}
.alert-ok{background:rgba(52,211,153,0.1);border:1px solid rgba(52,211,153,0.25);color:var(--success)}
.alert-err{background:rgba(248,113,113,0.1);border:1px solid rgba(248,113,113,0.25);color:var(--danger)}

/* Format grid */
.format-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px;margin-bottom:24px}
.format-card{
  background:rgba(255,255,255,0.02);border:1.5px solid var(--border);
  border-radius:14px;padding:20px;cursor:pointer;
  transition:all .2s;position:relative;overflow:hidden;
}
.format-card:hover{border-color:var(--border-bright);transform:translateY(-2px)}
.format-card.on{border-color:var(--accent);background:var(--accent-dim)}
.format-card.on::after{content:'‚úì';position:absolute;top:12px;right:14px;font-size:13px;font-weight:700;color:var(--accent)}
.format-icon{font-size:28px;margin-bottom:10px;display:block}
.format-name{font-size:14px;font-weight:700;color:var(--text);margin-bottom:4px}
.format-desc{font-size:12px;color:var(--text3);margin-bottom:10px;line-height:1.4}
.format-tags{display:flex;gap:6px;flex-wrap:wrap}
.format-tag{padding:2px 8px;border-radius:20px;font-size:10px;font-weight:700;letter-spacing:.3px;background:rgba(255,255,255,0.06);color:var(--text3);border:1px solid var(--border)}
.format-card.on .format-tag{background:rgba(124,108,240,0.15);color:var(--accent);border-color:rgba(124,108,240,0.3)}

/* Options card */
.card{background:rgba(255,255,255,0.035);border:1px solid var(--border);border-radius:14px;overflow:hidden;backdrop-filter:blur(12px);margin-bottom:16px}
.card-header{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.card-title{font-size:14px;font-weight:700}
.card-body{padding:20px}

.form-group{margin-bottom:16px}
.form-label{display:block;font-size:12px;font-weight:600;color:var(--text2);margin-bottom:7px;letter-spacing:.2px}
.form-select{width:100%;background:rgba(255,255,255,0.04);border:1px solid var(--border);border-radius:8px;padding:9px 12px;color:var(--text);font-size:13px;font-family:inherit;outline:none;transition:all .15s}
.form-select:focus{border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-dim)}
.form-select option{background:#1a1d2e}

.radio-row{display:flex;gap:10px;flex-wrap:wrap}
.radio-card{display:flex;align-items:center;gap:8px;padding:9px 14px;border:1px solid var(--border);border-radius:8px;cursor:pointer;transition:all .15s;background:rgba(255,255,255,0.02)}
.radio-card:hover{border-color:var(--border-bright)}
.radio-card.on{border-color:var(--accent);background:var(--accent-dim)}
.radio-card input{display:none}
.radio-dot{width:14px;height:14px;border-radius:50%;border:1.5px solid var(--border-bright);transition:all .15s;flex-shrink:0}
.radio-card.on .radio-dot{background:var(--accent);border-color:var(--accent);box-shadow:0 0 6px var(--accent-glow)}
.radio-label{font-size:12.5px;font-weight:500;color:var(--text2)}
.radio-card.on .radio-label{color:var(--accent)}

.check-row{display:flex;gap:10px;flex-wrap:wrap}
.check-pill{display:flex;align-items:center;gap:7px;padding:7px 13px;border:1px solid var(--border);border-radius:20px;cursor:pointer;transition:all .15s;background:rgba(255,255,255,0.02);font-size:12px;font-weight:500;color:var(--text2)}
.check-pill:hover{border-color:var(--border-bright);color:var(--text)}
.check-pill.on{border-color:var(--accent);background:var(--accent-dim);color:var(--accent)}
.check-pill input{display:none}

.export-btn-row{display:flex;gap:10px;margin-top:4px}
.export-btn-row .btn{flex:1;justify-content:center;padding:12px}

/* Recent exports */
.export-list{list-style:none}
.export-row{
  display:flex;align-items:center;gap:14px;
  padding:13px 16px;border-radius:10px;
  border:1px solid var(--border);margin-bottom:8px;
  background:rgba(255,255,255,0.02);transition:all .15s;
}
.export-row:last-child{margin-bottom:0}
.export-row:hover{background:rgba(255,255,255,0.04);border-color:var(--border-bright)}
.export-file-icon{width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;background:rgba(255,255,255,0.06)}
.export-info{flex:1;min-width:0}
.export-name{font-size:13px;font-weight:600;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.export-meta{font-size:11.5px;color:var(--text3);margin-top:2px}
.export-row-actions{display:flex;gap:6px;flex-shrink:0}
.icon-btn{padding:5px 9px;border:1px solid var(--border);background:rgba(255,255,255,0.03);border-radius:7px;cursor:pointer;transition:all .15s;font-size:12px;color:var(--text2)}
.icon-btn:hover{background:rgba(255,255,255,0.08);border-color:var(--border-bright);color:var(--text)}
</style>
</head>
<body>
<div class="app">

<aside class="sidebar">
  <div class="sidebar-logo">
    <div class="logo-icon">üéµ</div>
    <div><div class="logo-text">MusicSched</div><div class="logo-sub">Pro</div></div>
  </div>
  <div class="sidebar-section">Main</div>
  <a href="/" class="nav-item"><span class="nav-icon">‚äû</span>Dashboard</a>
  <a href="/generate" class="nav-item"><span class="nav-icon">‚ú¶</span>Generate Schedule</a>
  <a href="/view" class="nav-item"><span class="nav-icon">‚ó´</span>View Schedule</a>
  <a href="/export" class="nav-item active"><span class="nav-icon">‚Üë</span>Export Logs</a>
  <div class="sidebar-section">Library</div>
  <a href="#" class="nav-item"><span class="nav-icon">‚ô™</span>Song Library</a>
  <a href="#" class="nav-item"><span class="nav-icon">‚è±</span>Clock Templates</a>
  <a href="#" class="nav-item"><span class="nav-icon">‚óà</span>Rules Engine</a>
  <div class="sidebar-bottom">
    <div class="station-pill">
      <div class="station-avatar">P</div>
      <div><div class="station-name">Praise FM</div><div class="station-role">Administrator</div></div>
    </div>
  </div>
</aside>

<div class="main">
  <header class="topbar">
    <div>
      <div class="topbar-title">Export Logs</div>
      <div class="topbar-sub">Download schedules for your automation system</div>
    </div>
    <div class="topbar-right">
      <button class="btn btn-ghost" onclick="history.back()">‚Üê Back</button>
    </div>
  </header>

  <div class="content">

    <div class="alert" id="alertBox"></div>

    <!-- Format selection -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">Select Export Format</div>
        <span style="font-size:12px;color:var(--text3)">Click to toggle</span>
      </div>
      <div class="card-body">
        <div class="format-grid">
          <div class="format-card on" onclick="toggleFormat(this)">
            <span class="format-icon">üìª</span>
            <div class="format-name">Zetta</div>
            <div class="format-desc">RCS Zetta broadcast automation</div>
            <div class="format-tags"><span class="format-tag">LOG</span><span class="format-tag">XML</span></div>
          </div>
          <div class="format-card" onclick="toggleFormat(this)">
            <span class="format-icon">üéõÔ∏è</span>
            <div class="format-name">WideOrbit</div>
            <div class="format-desc">WideOrbit Traffic &amp; Billing</div>
            <div class="format-tags"><span class="format-tag">WO</span></div>
          </div>
          <div class="format-card" onclick="toggleFormat(this)">
            <span class="format-icon">üéöÔ∏è</span>
            <div class="format-name">ENCO</div>
            <div class="format-desc">ENCO DAD automation system</div>
            <div class="format-tags"><span class="format-tag">TXT</span></div>
          </div>
          <div class="format-card" onclick="toggleFormat(this)">
            <span class="format-icon">üìä</span>
            <div class="format-name">CSV</div>
            <div class="format-desc">Universal spreadsheet format</div>
            <div class="format-tags"><span class="format-tag">CSV</span></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Options -->
    <div class="card">
      <div class="card-header"><div class="card-title">Export Options</div></div>
      <div class="card-body">

        <div class="form-group">
          <label class="form-label">Date Range</label>
          <select class="form-select" id="dateRange">
            <option value="current">Current Week ‚Äî Feb 16‚Äì22, 2026</option>
            <option value="next">Next Week ‚Äî Feb 23‚ÄìMar 1, 2026</option>
            <option value="month">This Month ‚Äî February 2026</option>
            <option value="custom">Custom Range...</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Export Scope</label>
          <div class="radio-row" id="scopeRow">
            <label class="radio-card on">
              <input type="radio" name="scope" value="day" checked>
              <div class="radio-dot"></div>
              <span class="radio-label">One file per day</span>
            </label>
            <label class="radio-card">
              <input type="radio" name="scope" value="week">
              <div class="radio-dot"></div>
              <span class="radio-label">Single week file</span>
            </label>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Additional Options</label>
          <div class="check-row" id="addlOpts">
            <label class="check-pill on"><input type="checkbox" checked><span>Overnight fill</span></label>
            <label class="check-pill"><input type="checkbox"><span>Cart IDs</span></label>
            <label class="check-pill"><input type="checkbox"><span>Full metadata</span></label>
            <label class="check-pill"><input type="checkbox"><span>Timestamps</span></label>
          </div>
        </div>

        <div class="export-btn-row">
          <button class="btn btn-accent" onclick="doExport()">‚Üë &nbsp;Export Files</button>
          <button class="btn btn-ghost">üëÅ Preview</button>
        </div>

      </div>
    </div>

    <!-- Recent exports -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">Recent Exports</div>
        <button class="btn btn-ghost" style="padding:5px 10px;font-size:12px" onclick="location.reload()">‚Üª Refresh</button>
      </div>
      <div class="card-body">
        <ul class="export-list">
          <li class="export-row">
            <div class="export-file-icon">üìª</div>
            <div class="export-info">
              <div class="export-name">Zetta LOG ‚Äî Week of Feb 16‚Äì22</div>
              <div class="export-meta">7 files ¬∑ 845 KB ¬∑ 2 hours ago</div>
            </div>
            <div class="export-row-actions">
              <button class="icon-btn">üì• Download</button>
              <button class="icon-btn">üîÑ Re-export</button>
            </div>
          </li>
          <li class="export-row">
            <div class="export-file-icon">üìä</div>
            <div class="export-info">
              <div class="export-name">CSV ‚Äî February 2026</div>
              <div class="export-meta">1 file ¬∑ 1.2 MB ¬∑ Yesterday</div>
            </div>
            <div class="export-row-actions">
              <button class="icon-btn">üì• Download</button>
              <button class="icon-btn">üîÑ Re-export</button>
            </div>
          </li>
          <li class="export-row">
            <div class="export-file-icon">üéõÔ∏è</div>
            <div class="export-info">
              <div class="export-name">WideOrbit ‚Äî Week of Feb 9‚Äì15</div>
              <div class="export-meta">7 files ¬∑ 723 KB ¬∑ 3 days ago</div>
            </div>
            <div class="export-row-actions">
              <button class="icon-btn">üì• Download</button>
              <button class="icon-btn">üîÑ Re-export</button>
            </div>
          </li>
        </ul>
      </div>
    </div>

  </div>
</div>
</div>

<script>
function toggleFormat(el) { el.classList.toggle('on'); }

// Radio cards
document.querySelectorAll('#scopeRow .radio-card').forEach(card => {
  card.addEventListener('click', () => {
    document.querySelectorAll('#scopeRow .radio-card').forEach(c => {
      c.classList.remove('on');
      c.querySelector('input').checked = false;
    });
    card.classList.add('on');
    card.querySelector('input').checked = true;
  });
});

// Check pills
document.querySelectorAll('#addlOpts .check-pill').forEach(pill => {
  const cb = pill.querySelector('input');
  pill.addEventListener('click', () => {
    cb.checked = !cb.checked;
    pill.classList.toggle('on', cb.checked);
  });
});

function showAlert(msg, ok) {
  const el = document.getElementById('alertBox');
  el.className = 'alert show ' + (ok ? 'alert-ok' : 'alert-err');
  el.innerHTML = (ok ? '‚úì ' : '‚úó ') + msg;
  setTimeout(() => { el.className = 'alert'; }, 6000);
}

async function doExport() {
  const cards = document.querySelectorAll('.format-card.on');
  if (!cards.length) { showAlert('Select at least one format first.', false); return; }

  const formats = Array.from(cards).map(c => {
    const n = c.querySelector('.format-name').textContent.toLowerCase();
    if (n.includes('zetta'))     return 'zetta-log';
    if (n.includes('wideorbit')) return 'wideorbit';
    if (n.includes('enco'))      return 'enco';
    if (n.includes('csv'))       return 'csv';
  }).filter(Boolean);

  const scope = document.querySelector('input[name=scope]:checked')?.value || 'day';

  try {
    const res  = await fetch('/api/export', {
      method:'POST', headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ formats, scope, date_range: document.getElementById('dateRange').value })
    });
    const data = await res.json();
    if (data.success) showAlert(data.message + ` ‚Äî ${data.files_created} file(s) created`, true);
    else showAlert(data.error || 'Export failed', false);
  } catch(e) { showAlert('Network error: ' + e.message, false); }
}
</script>
</body>
</html>
